<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Speed of glue • glue</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet">
<meta property="og:title" content="Speed of glue">
<meta property="og:description" content="">
<meta property="og:image" content="https://glue.tidyverse.org/logo.png">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">glue</a>
        <div class="info">
          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.3.1.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/transformers.html">Transformers</a>
    </li>
    <li>
      <a href="../articles/speed.html">Speed of glue</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Release notes</li>
    <li>
      <a href="../articles/releases/glue-1.2.0.html">Version 1.2.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/glue">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Speed of glue</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/glue/blob/master/vignettes/speed.Rmd"><code>vignettes/speed.Rmd</code></a></small>
      <div class="hidden name"><code>speed.Rmd</code></div>

    </div>

    
    
<p>Glue is advertised as</p>
<blockquote>
<p>Fast, dependency free string literals</p>
</blockquote>
<p>So what do we mean when we say that glue is fast. This does not mean glue is the fastest thing to use in all cases, however for the features it provides we can confidently say it is fast.</p>
<p>A good way to determine this is to compare it’s speed of execution to some alternatives.</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/paste.html">base::paste0()</a></code>, <code><a href="https://rdrr.io/r/base/sprintf.html">base::sprintf()</a></code> - Functions in base R implemented in C that provide variable insertion (but not interpolation).</li>
<li>
<code><a href="https://rdrr.io/pkg/R.utils/man/gstring.html">R.utils::gstring()</a></code>, <code><a href="https://stringr.tidyverse.org/reference/str_interp.html">stringr::str_interp()</a></code> - Provides a similar interface as glue, but using <code>${}</code> to delimit blocks to interpolate.</li>
<li>
<code>pystr::pystr_format()</code><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, <code><a href="https://rdrr.io/pkg/rprintf/man/rprintf.html">rprintf::rprintf()</a></code> - Provide a interfaces similar to python string formatters with variable replacement, but not arbitrary interpolation.</li>
</ul>
<div id="simple-concatenation" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-concatenation" class="anchor"></a>Simple concatenation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">bar &lt;-<span class="st"> "baz"</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">simple &lt;-</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="st">  </span>microbenchmark<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span>(</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="dt">glue =</span> glue<span class="op">::</span><span class="kw"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span>(<span class="st">"foo{bar}"</span>),</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  <span class="dt">gstring =</span> R.utils<span class="op">::</span><span class="kw">gstring</span>(<span class="st">"foo${bar}"</span>),</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  <span class="dt">paste0 =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"foo"</span>, bar),</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  <span class="dt">sprintf =</span> <span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"foo%s"</span>, bar),</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="dt">str_interp =</span> stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_interp.html">str_interp</a></span>(<span class="st">"foo${bar}"</span>),</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  <span class="dt">rprintf =</span> rprintf<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rprintf/man/rprintf.html">rprintf</a></span>(<span class="st">"foo$bar"</span>, <span class="dt">bar =</span> bar)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="dt">unit =</span> <span class="st">"eps"</span>, <span class="dt">order =</span> <span class="st">"median"</span>, <span class="dt">signif =</span> <span class="dv">4</span>, simple)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; Unit: evaluations per second</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt;        expr      min     lq   mean median     uq     max neval</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt;     rprintf    329.4   2132   2218   2215   2364    2588   100</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt;     gstring     24.1   2642   2735   2758   2900    3486   100</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt;  str_interp   1007.0   3530   3829   3793   4132    5000   100</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt;        glue   1348.0   6912   7768   7523   8329   12980   100</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt;      paste0  49010.0 266700 465100 498100 608500  973700   100</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt;     sprintf 100300.0 397500 660000 619400 751900 1805000   100</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="kw">plot_comparison</span>(simple)</a></code></pre></div>
<p><img src="speed_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>While <code><a href="../reference/glue.html">glue()</a></code> is slower than <code>paste0</code>,<code><a href="https://rdrr.io/r/base/sprintf.html">sprintf()</a></code> it is twice as fast as <code>str_interp()</code> and <code>gstring()</code>, and on par with <code>rprintf()</code>.</p>
<p><code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code>, <code><a href="https://rdrr.io/r/base/sprintf.html">sprintf()</a></code> don’t do string interpolation and will likely always be significantly faster than glue, glue was never meant to be a direct replacement for them.</p>
<p><code>rprintf()</code> does only variable interpolation, not arbitrary expressions, which was one of the explicit goals of writing glue.</p>
<p>So glue is ~2x as fast as the two functions (<code>str_interp()</code>, <code>gstring()</code>) which do have roughly equivalent functionality.</p>
<p>It also is still quite fast, with over 6000 evaluations per second on this machine.</p>
</div>
<div id="vectorized-performance" class="section level2">
<h2 class="hasAnchor">
<a href="#vectorized-performance" class="anchor"></a>Vectorized performance</h2>
<p>Taking advantage of glue’s vectorization is the best way to avoid performance. For instance the vectorized form of the previous benchmark is able to generate 100,000 strings in only 22ms with performance much closer to that of <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> and <code><a href="https://rdrr.io/r/base/sprintf.html">sprintf()</a></code>. NB. <code>str_interp()</code> does not support vectorization, so were removed.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">bar &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"bar"</span>, <span class="fl">1e5</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">vectorized &lt;-</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="st">  </span>microbenchmark<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span>(</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="dt">glue =</span> glue<span class="op">::</span><span class="kw"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span>(<span class="st">"foo{bar}"</span>),</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  <span class="dt">gstring =</span> R.utils<span class="op">::</span><span class="kw">gstring</span>(<span class="st">"foo${bar}"</span>),</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  <span class="dt">paste0 =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"foo"</span>, bar),</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="dt">sprintf =</span> <span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"foo%s"</span>, bar),</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  <span class="dt">rprintf =</span> rprintf<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rprintf/man/rprintf.html">rprintf</a></span>(<span class="st">"foo$bar"</span>, <span class="dt">bar =</span> bar)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="dt">unit =</span> <span class="st">"ms"</span>, <span class="dt">order =</span> <span class="st">"median"</span>, <span class="dt">signif =</span> <span class="dv">4</span>, vectorized)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; Unit: milliseconds</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt;     expr   min    lq  mean median    uq   max neval</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt;  sprintf 11.79 11.95 12.23  12.12 12.36 16.36   100</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt;   paste0 13.32 13.57 13.83  13.71 13.99 18.38   100</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt;     glue 16.56 16.93 17.41  17.25 17.69 22.56   100</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt;  gstring 28.11 28.51 29.08  28.82 29.31 34.41   100</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt;  rprintf 46.52 47.15 48.23  47.88 49.04 54.47   100</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="kw">plot_comparison</span>(vectorized, <span class="dt">log =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="speed_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>pystr is no longer available from CRAN due to failure to correct installation errors and was therefore removed from further testing.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#simple-concatenation">Simple concatenation</a></li>
      <li><a href="#vectorized-performance">Vectorized performance</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="tidyverse">
  <p>glue is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by <a href="http://jimhester.com">Jim Hester</a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
